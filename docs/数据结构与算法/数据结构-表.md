数据结构— —表

本文介绍表这一数据结构，并提供Java语言的简单实现。

## 1. 表ADT

我们将形如 $A_0,A_1,A_2...A_{i-1},A_i,A_{i+1}...A_{n-1}$ 形式的数据结构称为表，表大小为n，空表则是指大小为0的表。

对于表中的元素（除了第一个元素$A_0$和最后一个元素$A_{n-1}$），都有一个前驱元素和后继元素，例如，以$A_i$为例，$A_i$的前驱元素为$A_{i-1}$，$A_i$的后继元素为$A_{i+1}$。第一个元素$A_0$只有后继元素，没有前驱元素；最后一个元素$A_{n-1}$只有前驱元素，没有后继元素。

对于表的操作，我们可以定义如下基本操作：

- `printList()`：按序输出数据
- `size()`：返回表大小
- `makeEmpty()`：将表置空
- `add(data)`：在表末尾增加一个数据元素data
- `insert(position, data)`：插入数据元素data，使之位于索引为position的位置
- `find(position)`：返回索引为position位置的数据元素
- `remove(position)`：删除引为position位置的数据元素

表与数组的区别：表可以动态扩容，而数组一旦定义后，长度不可改变。



## 2. 表的实现

为了简单起见以及更好地理解表这一数据结构，我们将表中的数据元素类型定义为整型。

### 2.1 基于数组的实现

```java
public class ArrayList {
    private static final int INIT_LENGTH = 10;

    private int[] data;
    private int size;

    public ArrayList(){
        data = new int[INIT_LENGTH];
        size = 0;
    }

    public void printList(){
        if(size == 0){
            System.out.println("[]");
        }else{
            System.out.print("[");
            for (int i = 0; i < size - 1; i++){
                System.out.print(data[i] + ", ");
            }
            System.out.print(data[size - 1]);
            System.out.println("]");
        }
    }

    public int size(){
        return size;
    }

    public void makeEmpty(){
        size = 0;
    }

    public void add(int element){
        growIfNecessary();

        // 将新的元素加到表末尾
        data[size] = element;
        size++;
    }

    public void insert(int position, int element) throws Exception {
        if (position < 0 || position > size){
            throw new Exception("invalid position");
        }

        growIfNecessary();

        // 将position位置后的元素后移，腾出position位置
        for(int i = size - 1; i >= position; i--){
            data[i + 1] = data[i];
        }

        data[position] = element;
        size++;
    }

    /**
     * 判断当前表容量是否能够容纳新的元素，如果不行，则进行扩容操作
     */
    private void growIfNecessary(){
        if(size == data.length){
            int[] newData = new int[data.length * 2];
            for (int i = 0; i < size; i++){
                newData[i] = data[i];
            }
            data = newData;
        }
    }

    public int find(int position) throws Exception {
        if (position < 0 || position >= size){
            throw new Exception("invalid position");
        }

        return data[position];
    }

    public void remove(int position) throws Exception {
        if (position < 0 || position >= size){
            throw new Exception("invalid position");
        }
        for(int i = position; i < size - 1; i++){
            data[i] = data[i+1];
        }
        size--;
    }
}

```



### 2.2 基于单链表的实现

```java
public class LinkedList {

    Node head;
    Node tail;
    int size;

    public LinkedList(){
        size = 0;
    }

    public void printList(){
        if(size == 0){
            System.out.println("[]");
        }else{
            System.out.print("[");
            Node p = head;
            while (p.next != null){
                System.out.print(p.data + ", ");
                p = p.next;
            }
            System.out.print(p.data);
            System.out.println("]");
        }
    }

    public int size(){
        return size;
    }

    public void makeEmpty(){
        size = 0;
        head = null;
    }

    public void add(int element){
        Node node = new Node(element, null);

        if(size == 0){
            head = node;
            tail = node;
        }else{
            tail.next = node;
            tail = tail.next;
        }

        size++;
    }

    public void insert(int position, int element) throws Exception {
        if (position < 0 || position > size){
            throw new Exception("invalid position");
        }

        Node p = head;
        for(int i = 0; i < position - 1; i++){
            p = p.next;
        }

        Node node = new Node(element, null);
        node.next = p.next;
        p.next = node;
        size++;
    }

    public int find(int position) throws Exception {
        if (position < 0 || position >= size){
            throw new Exception("invalid position");
        }

        Node p = head;
        for(int i = 0; i < position; i++){
            p = p.next;
        }

        return p.data;
    }

    public void remove(int position) throws Exception {
        if (position < 0 || position >= size){
            throw new Exception("invalid position");
        }

        Node p = head;
        for(int i = 0; i < position - 1; i++){
            p = p.next;
        }

        if(position == size - 1){
            p.next = null;
        }else {
            p.next = p.next.next;
        }
        size--;
    }


}

// 结点
class Node{
    public int data;
    public Node next;

    public Node(int data, Node next){
        this.data = data;
        this.next = next;
    }
}

```



## 3. 其他

### 3.1 双向链表

双向链表是指表中的结点有两个指针，一个指针prev指向前驱节点（如果没有前驱结点，则prev为null），一个指针next指向后继结点（如果没有后继结点，则next为null）。

结点定义如下：

```java
class Node{
    public int data;
    public Node prev;
    public Node next;

    public Node(int data, Node prev ,Node next){
        this.data = data;
        this.prev = prev;
        this.next = next;
    }
}
```



### 3.2 循环链表

循环链表与双向链表类似，只不过第一个结点的prev指针指向最后一个结点，最后一个结点的next指针指向第一个结点。


